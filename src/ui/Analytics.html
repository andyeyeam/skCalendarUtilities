<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analytics & Insights</title>
    <?!= include('ui/Styles'); ?>
  </head>
  <body>
    <div class="container">
      <!-- Back button -->
      <button class="back-button" onclick="navigateToMenu()">
        ‚Üê Back to Menu
      </button>

      <h1>Analytics & Insights</h1>

      <div class="card">
        <div class="empty-state">
          <h3>Coming Soon</h3>
          <p>Calendar analytics and insights will be available soon.</p>
          <p class="text-muted">
            Features include: time allocation analysis, scheduling patterns, and category breakdowns.
          </p>
        </div>
      </div>
    </div>

    <script>
      /**
       * Navigate back to menu
       */
      function navigateToMenu() {
        google.script.run
          .withSuccessHandler(function(html) {
            // Replace entire document with menu
            document.open();
            document.write(html);
            document.close();

            // Manually trigger initialization after document.write
            if (typeof window.initializeMenu === 'function') {
              window.initializeMenu();
            }
          })
          .withFailureHandler(function(error) {
            console.error('Failed to load menu:', error);
            alert('Failed to load menu: ' + error.message);
          })
          .loadMenu();
      }
    </script>
  </body>
</html>
